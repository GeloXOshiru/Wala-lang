local library = loadstring(game:HttpGet("https://raw.githubusercontent.com/HasrnXzeee/N/refs/heads/main/Image.png", true))()
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local startTime = os.time()
local startRebirths = player.leaderstats.Rebirths.Value
local displayName = player.DisplayName

-- Create Main Window
local window = library:AddWindow("Pampuksa sa mga hindot", {
    main_color = Color3.fromRGB(0, 0, 0),
    min_size = Vector2.new(670, 1000),
    can_resize = true,
})

-- Main Tab
local Main = window:AddTab("Main")
local farmPlusTab = window:AddTab("Farm")

Main:AddLabel("Local Player")

local walkSpeedValue = 16
Main:AddTextBox("WalkSpeed", function(text)
    local speed = tonumber(text)
    if speed and speed >= 1 and speed <= 500 then
        walkSpeedValue = speed
    end
end)

local setSpeed = false
Main:AddSwitch("Set Speed", function(state)
    setSpeed = state
    while setSpeed do
        game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = walkSpeedValue
        task.wait(0.1)
    end
    game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = 16
end)

local jumpPowerValue = 50
Main:AddTextBox("JumpPower", function(text)
    local jump = tonumber(text)
    if jump then
        jumpPowerValue = jump
    end
end)

local applyJumpPower = false
Main:AddSwitch("Apply JumpPower", function(state)
    applyJumpPower = state
    local humanoid = game.Players.LocalPlayer.Character.Humanoid
    humanoid.UseJumpPower = true
    humanoid.JumpPower = applyJumpPower and jumpPowerValue or 50
end)

local sizeValue = 1
Main:AddTextBox("Size", function(text)
    local size = tonumber(text)
    if size and size >= 1 and size <= 100 then
        sizeValue = size
    end
end)

local setSize = false
Main:AddSwitch("Set Sizes", function(state)
    setSize = state
    local char = game.Players.LocalPlayer.Character
    if char then
        local humanoid = char:FindFirstChildOfClass("Humanoid")
        if humanoid then
            for _, scale in pairs({"BodyDepthScale", "BodyHeightScale", "BodyWidthScale", "HeadScale"}) do
                local scaleInstance = humanoid:FindFirstChild(scale)
                if scaleInstance then
                    scaleInstance.Value = state and sizeValue or 1
                end
            end
        end
    end
end)

local Killer = window:AddTab("Puksa!")

local dropdown = Killer:AddDropdown("Select Pet", function(text)
    local petsFolder = game.Players.LocalPlayer:WaitForChild("petsFolder")
    for _, folder in pairs(petsFolder:GetChildren()) do
        if folder:IsA("Folder") then
            for _, pet in pairs(folder:GetChildren()) do
                game:GetService("ReplicatedStorage").rEvents.equipPetEvent:FireServer("unequipPet", pet)
            end
        end
    end
    task.wait(0.2)
    local petName = text
    local petsToEquip = {}
    for _, pet in pairs(petsFolder.Unique:GetChildren()) do
        if pet.Name == petName then
            table.insert(petsToEquip, pet)
        end
    end
    local maxPets = 8
    local equippedCount = math.min(#petsToEquip, maxPets)
    for i = 1, equippedCount do
        game:GetService("ReplicatedStorage").rEvents.equipPetEvent:FireServer("equipPet", petsToEquip[i])
        task.wait(0.1)
    end
end)
dropdown:Add("Wild Wizard")
dropdown:Add("Mighty Monster")

Killer:AddSwitch("Auto Punch [No Animation]", function(state)
	autoPunchNoAnim = state
	task.spawn(function()
		while autoPunchNoAnim do
			local punch = LocalPlayer.Backpack:FindFirstChild("Punch") or LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
			if punch then
				if punch.Parent ~= LocalPlayer.Character then
					punch.Parent = LocalPlayer.Character
				end
				LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
				LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
			else
				autoPunchNoAnim = false
			end
			task.wait(0.01)
		end
	end)
end)

Killer:AddSwitch("Auto Punch", function(state)
	_G.fastHitActive = state
	if state then
		task.spawn(function()
			while _G.fastHitActive do
				local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
				if punch then
					punch.Parent = LocalPlayer.Character
					if punch:FindFirstChild("attackTime") then
						punch.attackTime.Value = 0
					end
				end
				task.wait(0.1)
			end
		end)
		task.spawn(function()
			while _G.fastHitActive do
				local punch = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
				if punch then
					punch:Activate()
				end
				task.wait(0.1)
			end
		end)
	else
		local punch = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
		if punch then
			punch.Parent = LocalPlayer.Backpack
		end
	end
end)

Killer:AddSwitch("Fast Punch", function(state)
	_G.autoPunchActive = state
	if state then
		task.spawn(function()
			while _G.autoPunchActive do
				local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
				if punch then
					punch.Parent = LocalPlayer.Character
					if punch:FindFirstChild("attackTime") then
						punch.attackTime.Value = 0
					end
				end
				task.wait()
			end
		end)
		task.spawn(function()
			while _G.autoPunchActive do
				local punch = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
				if punch then
					punch:Activate()
				end
				task.wait()
			end
		end)
	else
		local punch = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Punch")
		if punch then
			punch.Parent = LocalPlayer.Backpack
		end
	end
end)

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterPack = game:GetService("StarterPack")
local lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer

-- State & connection tracking
local comboActive = false
local connections = {} -- map keys -> RBXScriptConnection / task.thread
local loops = {} -- store coroutine/thread references to allow safe stopping

local function safeDisconnect(key)
	local conn = connections[key]
	if not conn then return end
	pcall(function()
		if typeof(conn) == "RBXScriptConnection" and conn.Disconnect then
			conn:Disconnect()
		elseif type(conn) == "table" and conn.Disconnect then
			conn:Disconnect()
		end
	end)
	connections[key] = nil
end

local function stopLoops()
	for k, thr in pairs(loops) do
		loops[k] = nil
	end
end

local function cleanupAll()
	_G.AutoPunchToggle = false
	_G.AutoProteinEgg = false
	getgenv().AntiFlyActive = false

	for k, _ in pairs(connections) do
		safeDisconnect(k)
	end
	connections = {}
	stopLoops()
end

local function respawnPlayer()
	pcall(function()
		if LocalPlayer and LocalPlayer:IsA("Player") then
			if pcall(function() LocalPlayer:LoadCharacter() end) then return end
			pcall(function()
				local StarterGui = game:GetService("StarterGui")
				StarterGui:SetCore("ResetButtonCallback", true)
			end)
		end
	end)
end

local function applySizeNaN()
	pcall(function()
		local events = ReplicatedStorage:FindFirstChild("rEvents")
		if events then
			local change = events:FindFirstChild("changeSpeedSizeRemote")
			if change and change.InvokeServer then
				pcall(function()
					change:InvokeServer("changeSize", 0/0)
				end)
			end
		end
	end)
end

local function startAutoPunch()
	_G.AutoPunchToggle = true
	local id = "AutoPunch"
	loops[id] = true
	task.spawn(function()
		local backpack = LocalPlayer:WaitForChild("Backpack")
		local hand = "rightHand"
		local function getMuscleEvent() return LocalPlayer:FindFirstChild("muscleEvent") end

		safeDisconnect("CharAddedForAutoPunch")
		connections.CharAddedForAutoPunch = LocalPlayer.CharacterAdded:Connect(function(char)
			if comboActive and connections.HumanoidResetHook == nil then
				local hum = char:FindFirstChildOfClass("Humanoid")
				if hum then
					safeDisconnect("ResetDeath")
					connections.ResetDeath = hum.Died:Connect(function()
						task.wait(0.5)
						respawnPlayer()
					end)
				end
			end
		end)

		safeDisconnect("BackpackChildForAutoPunch")
		connections.BackpackChildForAutoPunch = LocalPlayer.ChildAdded:Connect(function(child)
			if child.Name == "Backpack" then
				backpack = child
			end
		end)

		while _G.AutoPunchToggle and loops[id] do
			local muscleEvent = getMuscleEvent()
			local character = LocalPlayer.Character
			if character and character:FindFirstChild("Humanoid") and muscleEvent then
				local punchEquipped = character:FindFirstChild("Punch")
				local punchInBackpack = (LocalPlayer:FindFirstChild("Backpack") and LocalPlayer.Backpack:FindFirstChild("Punch"))
				if not punchEquipped and punchInBackpack then
					pcall(function() character.Humanoid:EquipTool(punchInBackpack) end)
				end
				pcall(function() muscleEvent:FireServer("punch", hand) end)
			end
			task.wait(0.0001)
		end
	end)
end

local function startProteinEggLogic()
	_G.AutoProteinEgg = true
	local id = "ProteinEgg"
	loops[id] = true
	task.spawn(function()
		local toolName = "Protein Egg"
		local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

		local function restoreVisibility(tool)
			for _, part in ipairs(tool:GetDescendants()) do
				if part:IsA("BasePart") then
					pcall(function() part.Transparency = 0 end)
					pcall(function() part.LocalTransparencyModifier = 0 end)
				end
			end
		end

		local function findTool()
			local tool = (LocalPlayer:FindFirstChild("Backpack") and LocalPlayer.Backpack:FindFirstChild(toolName))
			if tool then return tool end
			tool = StarterPack:FindFirstChild(toolName)
			if tool then return tool end
			tool = ReplicatedStorage:FindFirstChild(toolName)
			return tool
		end

		local function forceEquip(tool)
			if not (character and character:FindFirstChild("Humanoid")) then return end
			pcall(function() character.Humanoid:EquipTool(tool) end)
			task.wait(0.1)
			if not character:FindFirstChild(toolName) then
				pcall(function() tool.Parent = character end)
				task.wait(0.1)
			end
			local equipped = character:FindFirstChild(toolName)
			if equipped then restoreVisibility(equipped) end
		end

		local function sanitizeTool(tool)
			for _, desc in ipairs(tool:GetDescendants()) do
				if desc:IsA("Script") then
					pcall(function() desc:Destroy() end)
				elseif desc:IsA("LocalScript") then
					pcall(function() desc.Disabled = true end)
				end
				if desc:IsA("RemoteEvent") then
					pcall(function() desc.FireServer = function() end end)
				end
			end
		end

		local function equipIfNeeded()
			if not _G.AutoProteinEgg then return end
			character = LocalPlayer.Character
			local equipped = character and character:FindFirstChild(toolName)
			local needEquip = false
			if not equipped then
				needEquip = true
			else
				for _, part in ipairs(equipped:GetDescendants()) do
					if part:IsA("BasePart") and part.Transparency > 0 then
						needEquip = true
						break
					end
				end
			end
			if needEquip then
				local tool = findTool()
				if tool then
					if tool.Parent ~= (LocalPlayer:FindFirstChild("Backpack") and LocalPlayer.Backpack) then
						local clone = tool:Clone()
						clone.Parent = LocalPlayer:FindFirstChild("Backpack") or LocalPlayer
						tool = clone
					end
					sanitizeTool(tool)
					forceEquip(tool)
				end
			end
		end

		local function monitorToolContainer(container)
			if not container then return end
			for _, tool in ipairs(container:GetChildren()) do
				if tool:IsA("Tool") and tool.Name == toolName then
					sanitizeTool(tool)
				end
			end
			local conn = container.ChildAdded:Connect(function(child)
				if child:IsA("Tool") and child.Name == toolName then
					task.defer(function()
						sanitizeTool(child)
					end)
				end
			end)
			return conn
		end

		safeDisconnect("MonitorBackpack")
		safeDisconnect("MonitorCharacter")
		connections.MonitorBackpack = monitorToolContainer(LocalPlayer:FindFirstChild("Backpack") or LocalPlayer:WaitForChild("Backpack"))
		connections.MonitorCharacter = monitorToolContainer(LocalPlayer.Character)

		safeDisconnect("CharacterAddedProtein")
		connections.CharacterAddedProtein = LocalPlayer.CharacterAdded:Connect(function(char)
			character = char
			task.wait(1)
			safeDisconnect("MonitorBackpack")
			safeDisconnect("MonitorCharacter")
			connections.MonitorBackpack = monitorToolContainer(LocalPlayer:FindFirstChild("Backpack") or LocalPlayer:WaitForChild("Backpack"))
			connections.MonitorCharacter = monitorToolContainer(char)
			equipIfNeeded()
		end)

		safeDisconnect("BackpackChildProtein")
		connections.BackpackChildProtein = LocalPlayer:WaitForChild("Backpack").ChildAdded:Connect(function(child)
			if _G.AutoProteinEgg and child.Name == toolName then
				task.wait(0.2)
				equipIfNeeded()
			end
		end)

		while _G.AutoProteinEgg and loops[id] do
			pcall(equipIfNeeded)
			task.wait(0.5)
		end
	end)
end

local function startAntiFly()
	getgenv().AntiFlyActive = true
	safeDisconnect("AntiFly")
	connections.AntiFly = RunService.Heartbeat:Connect(function()
		local char = LocalPlayer.Character
		if not char then return end
		local root = char:FindFirstChild("HumanoidRootPart")
		if not root then return end
		local humanoid = char:FindFirstChildOfClass("Humanoid")
		if not humanoid then return end
		local ray = Ray.new(root.Position, Vector3.new(0, -500, 0))
		local hit, position = workspace:FindPartOnRay(ray, char)
		if hit then
			local groundY = position.Y
			local currentY = root.Position.Y
			if currentY - groundY > 0.5 then
				root.CFrame = CFrame.new(root.Position.X, groundY + 0.5, root.Position.Z)
				humanoid.PlatformStand = true
				humanoid.PlatformStand = false
			end
		end
	end)
end

local function softAntiLagAndSunset()
	pcall(function()
		local classesToClean = {["ParticleEmitter"]=true, ["Trail"]=true, ["Smoke"]=true, ["Fire"]=true}
		for _, obj in ipairs(workspace:GetChildren()) do
			if obj:IsA("Model") or obj:IsA("Part") then
				for _, sub in ipairs(obj:GetChildren()) do
					if classesToClean[sub.ClassName] then
						pcall(function() sub:Destroy() end)
					end
				end
			end
		end
		local terrain = workspace:FindFirstChildOfClass("Terrain")
		if terrain then
			terrain.WaterWaveSize = 0
			terrain.WaterReflectance = 0
			terrain.WaterTransparency = 1
		end
	end)
	pcall(function()
		lighting.ClockTime = 18
		lighting.Brightness = 1.5
		lighting.OutdoorAmbient = Color3.fromRGB(150, 100, 80)
		lighting.FogColor = Color3.fromRGB(200, 120, 100)
		lighting.FogEnd = 500
		for _, v in ipairs(lighting:GetChildren()) do
			if v:IsA("Sky") then
				pcall(function() v:Destroy() end)
			end
		end
		local sky = Instance.new("Sky")
		sky.Name = "SunsetSky"
		sky.SkyboxBk = "rbxassetid://131889017"
		sky.SkyboxDn = "rbxassetid://131889017"
		sky.SkyboxFt = "rbxassetid://131889017"
		sky.SkyboxLf = "rbxassetid://131889017"
		sky.SkyboxRt = "rbxassetid://131889017"
		sky.SkyboxUp = "rbxassetid://131889017"
		sky.SunAngularSize = 10
		sky.MoonAngularSize = 0
		sky.SunTextureId = "rbxassetid://644432992"
		sky.Parent = lighting
	end)
end

local function hookResetOnCharacter(char)
	if not char then return end
	local humanoid = char:FindFirstChildOfClass("Humanoid")
	safeDisconnect("ResetDeath")
	connections.ResetDeath = humanoid.Died:Connect(function()
		task.wait(0.5)
		respawnPlayer()
	end)
end

local function startTinyIslandLoop()
	local id = "TinyIslandLoop"
	loops[id] = true
	task.spawn(function()
		local teleportPos = CFrame.new(-37.1, 9.2, 1919)
		while comboActive and loops[id] do
			pcall(function()
				local char = LocalPlayer.Character
				if char and char:FindFirstChild("HumanoidRootPart") then
					char.HumanoidRootPart.CFrame = teleportPos
				end
			end)
			task.wait(0.2)
		end
	end)
end

-- ðŸ”¹ Killer:AddSwitch version
Killer:AddSwitch("OP Punch When Dead | Combo", function(enabled)
	comboActive = enabled
	cleanupAll()

	if enabled then
		applySizeNaN()
		startAutoPunch()
		startProteinEggLogic()
		startAntiFly()
		softAntiLagAndSunset()
		startTinyIslandLoop()

		if LocalPlayer.Character then
			hookResetOnCharacter(LocalPlayer.Character)
		end
		safeDisconnect("CharacterAddedReset")
		connections.CharacterAddedReset = LocalPlayer.CharacterAdded:Connect(function(char)
			task.wait(0.5)
			hookResetOnCharacter(char)
		end)
	end
end)

Killer:AddButton("NaN Size", function()
    local args = {"changeSize", 0/0}
    game:GetService("ReplicatedStorage"):WaitForChild("rEvents"):WaitForChild("changeSpeedSizeRemote"):InvokeServer(unpack(args))
end)

local button = Killer:AddButton("Remove Punch Anim", function()
    local blockedAnimations = {
        ["rbxassetid://3638729053"] = true,
        ["rbxassetid://3638767427"] = true,
    }

    local function setupAnimationBlocking()
        local char = game.Players.LocalPlayer.Character
        if not char or not char:FindFirstChild("Humanoid") then return end

        local humanoid = char:FindFirstChild("Humanoid")

        for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
            if track.Animation then
                local animId = track.Animation.AnimationId
                local animName = track.Name:lower()

                if blockedAnimations[animId] or
                    animName:match("punch") or
                    animName:match("attack") or
                    animName:match("right") then
                    track:Stop()
                end
            end
        end

        if not _G.AnimBlockConnection then
            local connection = humanoid.AnimationPlayed:Connect(function(track)
                if track.Animation then
                    local animId = track.Animation.AnimationId
                    local animName = track.Name:lower()

                    if blockedAnimations[animId] or
                        animName:match("punch") or
                        animName:match("attack") or
                        animName:match("right") then
                        track:Stop()
                    end
                end
            end)

            _G.AnimBlockConnection = connection
        end
    end

    setupAnimationBlocking()

    local function overrideToolActivation()
        local function processTool(tool)
            if tool and (tool.Name == "Punch" or tool.Name:match("Attack") or tool.Name:match("Right")) then
                if not tool:GetAttribute("ActivatedOverride") then
                    tool:SetAttribute("ActivatedOverride", true)

                    local connection = tool.Activated:Connect(function()
                        task.wait(0.05)

                        local char = game.Players.LocalPlayer.Character
                        if char and char:FindFirstChild("Humanoid") then
                            for _, track in pairs(char.Humanoid:GetPlayingAnimationTracks()) do
                                if track.Animation then
                                    local animId = track.Animation.AnimationId
                                    local animName = track.Name:lower()

                                    if blockedAnimations[animId] or
                                        animName:match("punch") or
                                        animName:match("attack") or
                                        animName:match("right") then
                                        track:Stop()
                                    end
                                end
                            end
                        end
                    end)

                    if not _G.ToolConnections then
                        _G.ToolConnections = {}
                    end
                    _G.ToolConnections[tool] = connection
                end
            end
        end

        for _, tool in pairs(game.Players.LocalPlayer.Backpack:GetChildren()) do
            processTool(tool)
        end

        local char = game.Players.LocalPlayer.Character
        if char then
            for _, tool in pairs(char:GetChildren()) do
                if tool:IsA("Tool") then
                    processTool(tool)
                end
            end
        end

        if not _G.BackpackAddedConnection then
            _G.BackpackAddedConnection = game.Players.LocalPlayer.Backpack.ChildAdded:Connect(function(child)
                if child:IsA("Tool") then
                    task.wait(0.1)
                    processTool(child)
                end
            end)
        end

        if not _G.CharacterToolAddedConnection and char then
            _G.CharacterToolAddedConnection = char.ChildAdded:Connect(function(child)
                if child:IsA("Tool") then
                    task.wait(0.1)
                    processTool(child)
                end
            end)
        end
    end

    overrideToolActivation()

    if not _G.AnimMonitorConnection then
        _G.AnimMonitorConnection = game:GetService("RunService").Heartbeat:Connect(function()
            if tick() % 0.5 < 0.01 then
                local char = game.Players.LocalPlayer.Character
                if char and char:FindFirstChild("Humanoid") then
                    for _, track in pairs(char.Humanoid:GetPlayingAnimationTracks()) do
                        if track.Animation then
                            local animId = track.Animation.AnimationId
                            local animName = track.Name:lower()

                            if blockedAnimations[animId] or
                                animName:match("punch") or
                                animName:match("attack") or
                                animName:match("right") then
                                track:Stop()
                            end
                        end
                    end
                end
            end
        end)
    end

    if not _G.CharacterAddedConnection then
        _G.CharacterAddedConnection = game.Players.LocalPlayer.CharacterAdded:Connect(function(newChar)
            task.wait(1)
            setupAnimationBlocking()
            overrideToolActivation()

            if _G.CharacterToolAddedConnection then
                _G.CharacterToolAddedConnection:Disconnect()
            end

            _G.CharacterToolAddedConnection = newChar.ChildAdded:Connect(function(child)
                if child:IsA("Tool") then
                    task.wait(0.1)
                    processTool(child)
                end
            end)
        end)
    end
end)

function RecoveryPunch()
    if _G.AnimBlockConnection then
        _G.AnimBlockConnection:Disconnect()
        _G.AnimBlockConnection = nil
    end
    if _G.AnimMonitorConnection then
        _G.AnimMonitorConnection:Disconnect()
        _G.AnimMonitorConnection = nil
    end
    if _G.ToolConnections then
        for _, conn in pairs(_G.ToolConnections) do
            if conn then conn:Disconnect() end
        end
        _G.ToolConnections = nil
    end
    if _G.BackpackAddedConnection then
        _G.BackpackAddedConnection:Disconnect()
        _G.BackpackAddedConnection = nil
    end
    if _G.CharacterToolAddedConnection then
        _G.CharacterToolAddedConnection:Disconnect()
        _G.CharacterToolAddedConnection = nil
    end
    if _G.CharacterAddedConnection then
        _G.CharacterAddedConnection:Disconnect()
        _G.CharacterAddedConnection = nil
    end
end

Killer:AddButton("Recover Punch Anim", function()
    RecoveryPunch()
end)

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local friendWhitelistActive = false

Killer:AddSwitch("Auto Whitelist Friends (Fast Function) ", function(state)
    friendWhitelistActive = state

    if state then
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer and LocalPlayer:IsFriendsWith(player.UserId) then
                playerWhitelist[player.Name] = true
            end
        end

        Players.PlayerAdded:Connect(function(player)
            if friendWhitelistActive and player ~= LocalPlayer and LocalPlayer:IsFriendsWith(player.UserId) then
                playerWhitelist[player.Name] = true
            end
        end)
    else
        for name in pairs(playerWhitelist) do
            local friend = Players:FindFirstChild(name)
            if friend and LocalPlayer:IsFriendsWith(friend.UserId) then
                playerWhitelist[name] = nil
            end
        end
    end
end)

Killer:AddTextBox("Whitelist", function(text)
    local target = Players:FindFirstChild(text)
    if target then
        playerWhitelist[target.Name] = true
    end
end)

Killer:AddTextBox("UnWhitelist", function(text)
    local target = Players:FindFirstChild(text)
    if target then
        playerWhitelist[target.Name] = nil
    end
end)

Killer:AddSwitch("Auto Kill", function(bool)
    autoKill = bool

    task.spawn(function()
        while autoKill do
            local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
            local rightHand = character:FindFirstChild("RightHand")
            local leftHand = character:FindFirstChild("LeftHand")

            local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
            if punch and not character:FindFirstChild("Punch") then
                punch.Parent = character
            end

            if rightHand and leftHand then
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= LocalPlayer and not playerWhitelist[target.Name] then
                        local targetChar = target.Character
                        local rootPart = targetChar and targetChar:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            pcall(function()
                                firetouchinterest(rightHand, rootPart, 1)
                                firetouchinterest(leftHand, rootPart, 1)
                                firetouchinterest(rightHand, rootPart, 0)
                                firetouchinterest(leftHand, rootPart, 0)
                            end)
                        end
                    end
                end
            end

            task.wait(0.05)
        end
    end)
end)

local targetDropdown = Killer:AddDropdown("Select Target", function(name)
    if name and not table.find(targetPlayerNames, name) then
        table.insert(targetPlayerNames, name)
    end
end)

Killer:AddTextBox("Remove Target", function(name)
    for i, v in ipairs(targetPlayerNames) do
        if v == name then
            table.remove(targetPlayerNames, i)
            break
        end
    end
end)

for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        targetDropdown:Add(player.Name)
        targetDropdownItems[player.Name] = true
    end
end

Players.PlayerAdded:Connect(function(player)
    if player ~= LocalPlayer then
        targetDropdown:Add(player.Name)
        targetDropdownItems[player.Name] = true
    end
end)

Players.PlayerRemoving:Connect(function(player)
    if targetDropdownItems[player.Name] then
        targetDropdownItems[player.Name] = nil
        targetDropdown:Clear()
        for name in pairs(targetDropdownItems) do
            targetDropdown:Add(name)
        end
    end

    for i = #targetPlayerNames, 1, -1 do
        if targetPlayerNames[i] == player.Name then
            table.remove(targetPlayerNames, i)
        end
    end
end)

Killer:AddSwitch("Start Kill Target", function(state)
    killTarget = state

    task.spawn(function()
        while killTarget do
            local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

            local punch = LocalPlayer.Backpack:FindFirstChild("Punch")
            if punch and not character:FindFirstChild("Punch") then
                punch.Parent = character
            end

            local rightHand = character:WaitForChild("RightHand", 5)
            local leftHand = character:WaitForChild("LeftHand", 5)

            if rightHand and leftHand then
                for _, name in ipairs(targetPlayerNames) do
                    local target = Players:FindFirstChild(name)
                    if target and target ~= LocalPlayer then
                        local rootPart = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                        if rootPart then
                            pcall(function()
                                firetouchinterest(rightHand, rootPart, 1)
                                firetouchinterest(leftHand, rootPart, 1)
                                firetouchinterest(rightHand, rootPart, 0)
                                firetouchinterest(leftHand, rootPart, 0)
                            end)
                        end
                    end
                end
            end

            task.wait(0.05)
        end
    end)
end)

local spyTargetDropdown = Killer:AddDropdown("Select View Target", function(name)
    targetPlayerName = name
end)

for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        spyTargetDropdown:Add(player.Name)
    end
end

Players.PlayerAdded:Connect(function(player)
    if player ~= LocalPlayer then
        spyTargetDropdown:Add(player.Name)
    end
end)

Players.PlayerRemoving:Connect(function(player)
    if player ~= LocalPlayer then
        spyTargetDropdown:Clear()
        for _, plr in ipairs(Players:GetPlayers()) do
            if plr ~= LocalPlayer then
                spyTargetDropdown:Add(plr.Name)
            end
        end
    end
end)

Killer:AddSwitch("View Player", function(bool)
    spying = bool
    if not spying then
        local cam = workspace.CurrentCamera
        cam.CameraSubject = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") or LocalPlayer
        return
    end
    task.spawn(function()
        while spying do
            local target = Players:FindFirstChild(targetPlayerName)
            if target and target ~= LocalPlayer then
                local humanoid = target.Character and target.Character:FindFirstChild("Humanoid")
                if humanoid then
                    workspace.CurrentCamera.CameraSubject = humanoid
                end
            end
            task.wait(0.1)
        end
    end)
end)

Killer:AddSwitch("Auto Good Karma", function(bool)
    autoGoodKarma = bool
    task.spawn(function()
        while autoGoodKarma do
            local playerChar = LocalPlayer.Character
            local rightHand = playerChar and playerChar:FindFirstChild("RightHand")
            local leftHand = playerChar and playerChar:FindFirstChild("LeftHand")
            if playerChar and rightHand and leftHand then
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= LocalPlayer then
                        local evilKarma = target:FindFirstChild("evilKarma")
                        local goodKarma = target:FindFirstChild("goodKarma")
                        if evilKarma and goodKarma and evilKarma:IsA("IntValue") and goodKarma:IsA("IntValue") and evilKarma.Value > goodKarma.Value then
                            local rootPart = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                            if rootPart then
                                firetouchinterest(rightHand, rootPart, 1)
                                firetouchinterest(leftHand, rootPart, 1)
                                firetouchinterest(rightHand, rootPart, 0)
                                firetouchinterest(leftHand, rootPart, 0)
                            end
                        end
                    end
                end
            end
            task.wait(0.01)
        end
    end)
end)

Killer:AddSwitch("Auto Bad Karma (Fast Auto Kill) ", function(bool)
    autoBadKarma = bool
    task.spawn(function()
        while autoBadKarma do
            local playerChar = LocalPlayer.Character
            local rightHand = playerChar and playerChar:FindFirstChild("RightHand")
            local leftHand = playerChar and playerChar:FindFirstChild("LeftHand")
            if playerChar and rightHand and leftHand then
                for _, target in ipairs(Players:GetPlayers()) do
                    if target ~= LocalPlayer then
                        local evilKarma = target:FindFirstChild("evilKarma")
                        local goodKarma = target:FindFirstChild("goodKarma")
                        if evilKarma and goodKarma and evilKarma:IsA("IntValue") and goodKarma:IsA("IntValue") and goodKarma.Value > evilKarma.Value then
                            local rootPart = target.Character and target.Character:FindFirstChild("HumanoidRootPart")
                            if rootPart then
                                firetouchinterest(rightHand, rootPart, 1)
                                firetouchinterest(leftHand, rootPart, 1)
                                firetouchinterest(rightHand, rootPart, 0)
                                firetouchinterest(leftHand, rootPart, 0)
                            end
                        end
                    end
                end
            end
            task.wait(0.01)
        end
    end)
end)

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local following = false
local followTarget = nil

-- ðŸ“Œ FunciÃ³n: TP detrÃ¡s del jugador
local function followPlayer(targetPlayer)
    local myChar = LocalPlayer.Character
    local targetChar = targetPlayer.Character

    if not (myChar and targetChar) then return end
    local myHRP = myChar:FindFirstChild("HumanoidRootPart")
    local targetHRP = targetChar:FindFirstChild("HumanoidRootPart")

    if myHRP and targetHRP then
        local followPos = targetHRP.Position - (targetHRP.CFrame.LookVector * 3)
        myHRP.CFrame = CFrame.new(followPos, targetHRP.Position)
    end
end

-- ðŸ“Œ Dropdown dinÃ¡mico de jugadores
local followDropdown = Killer:AddDropdown("Teleport player", function(selectedDisplayName)
    if selectedDisplayName and selectedDisplayName ~= "" then
        -- Buscar jugador por DisplayName
        local target = nil
        for _, plr in ipairs(Players:GetPlayers()) do
            if plr.DisplayName == selectedDisplayName then
                target = plr
                break
            end
        end

        if target then
            followTarget = target.Name -- Guardamos Name real para seguir
            following = true
            print("âœ… Started following:", target.Name)

            -- TP inmediato
            followPlayer(target)
        end
    end
end)

-- ðŸ“Œ Inicializar lista con DisplayNames
for _, player in ipairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        followDropdown:Add(player.DisplayName)
    end
end

-- ðŸ“Œ Actualizar lista cuando entren jugadores
Players.PlayerAdded:Connect(function(player)
    if player ~= LocalPlayer then
        followDropdown:Add(player.DisplayName)
    end
end)

-- ðŸ“Œ Actualizar lista cuando se vayan jugadores
Players.PlayerRemoving:Connect(function(player)
    -- Limpiamos y agregamos de nuevo
    followDropdown:Clear()
    for _, plr in ipairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            followDropdown:Add(plr.DisplayName)
        end
    end

    -- Dejar de seguir si se fue
    if followTarget == player.Name then
        followTarget = nil
        following = false
    end
end)

-- ðŸ“Œ BotÃ³n para dejar de seguir
Killer:AddButton("Stop Follow", function()
    following = false
    followTarget = nil
    print("â›” Stopped following")
end)

-- ðŸ“Œ Loop de seguimiento automÃ¡tico
task.spawn(function()
    while task.wait(0.01) do
        if following and followTarget then
            local target = Players:FindFirstChild(followTarget)
            if target then
                followPlayer(target)
            else
                following = false
                followTarget = nil
            end
        end
    end
end)

-- ðŸ“Œ Reintentar cuando respawnees
LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    if following and followTarget then
        local target = Players:FindFirstChild(followTarget)
        if target then
            followPlayer(target)
        end
    end
end)

local godDamageActive = false

Killer:AddSwitch("auto slams", function(state)
    godDamageActive = state
    if state then
        task.spawn(function()
            while godDamageActive do
                local player = LocalPlayer
                local groundSlam = player.Backpack:FindFirstChild("Ground Slam") or (player.Character and player.Character:FindFirstChild("Ground Slam"))

                if groundSlam then
                    if groundSlam.Parent == player.Backpack then
                        groundSlam.Parent = player.Character
                    end
                    if groundSlam:FindFirstChild("attackTime") then
                        groundSlam.attackTime.Value = 0
                    end
                    player.muscleEvent:FireServer("slam")
                    groundSlam:Activate()
                end

                task.wait(0.1)
            end
        end)
    end
end)

local serverTab = window:AddTab("Server")

serverTab:AddLabel("Server Options")

-- Add ad removal button to Misc 1
serverTab:AddButton("Remove Portals", function()
    -- Remove existing ad portals
    for _, portal in pairs(game:GetDescendants()) do
        if portal.Name == "RobloxForwardPortals" then
            portal:Destroy()
        end
    end
    
    -- Set up connection to remove future ad portals
    if _G.AdRemovalConnection then
        _G.AdRemovalConnection:Disconnect()
    end
    
    _G.AdRemovalConnection = game.DescendantAdded:Connect(function(descendant)
        if descendant.Name == "RobloxForwardPortals" then
            descendant:Destroy()
        end
    end)
    
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Ads Removed",
        Text = "Roblox ads have been removed",
        Duration = 0
    })
end)

serverTab:AddButton("Anti AFK", function()
     loadstring(game:HttpGet("https://raw.githubusercontent.com/SonzyxDev/GPMR/refs/heads/main/GaramondV2"))()
end)

serverTab:AddButton("Less Lag", function()
    for _, v in pairs(game:GetDescendants()) do
        if v:IsA("ParticleEmitter") or v:IsA("Smoke") or v:IsA("Fire") or v:IsA("Sparkles") then
            v.Enabled = false
        end
    end
 
    local lighting = game:GetService("Lighting")
    lighting.GlobalShadows = false
    lighting.FogEnd = 9e9
    lighting.Brightness = 0
 
    settings().Rendering.QualityLevel = 1
 
    for _, v in pairs(game:GetDescendants()) do
        if v:IsA("Decal") or v:IsA("Texture") then
            v.Transparency = 1
        elseif v:IsA("BasePart") and not v:IsA("MeshPart") then
            v.Material = Enum.Material.SmoothPlastic
            if v.Parent and (v.Parent:FindFirstChild("Humanoid") or v.Parent.Parent:FindFirstChild("Humanoid")) then
            else
                v.Reflectance = 0
            end
        end
    end
 
    for _, v in pairs(lighting:GetChildren()) do
        if v:IsA("BlurEffect") or v:IsA("SunRaysEffect") or v:IsA("ColorCorrectionEffect") or v:IsA("BloomEffect") or v:IsA("DepthOfFieldEffect") then
            v.Enabled = false
        end
    end
 
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Optimization",
        Text = "Full optimization applied!",
        Duration = 5
    })
end)

serverTab:AddButton("Rejoin Server", function()
    local ts = game:GetService("TeleportService")
    local p = game:GetService("Players").LocalPlayer
    ts:Teleport(game.PlaceId, p)
end)
 
local joinLowPlayerServerSwitch = serverTab:AddSwitch("Join Low Player Server", function(bool)
    if bool then
        local module = loadstring(game:HttpGet("https://raw.githubusercontent.com/LeoKholYt/roblox/main/lk_serverhop.lua"))()
        module:Teleport(game.PlaceId, "Lowest")
    end
end)
